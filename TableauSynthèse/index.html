<!DOCTYPE html>
<html lang="fr-FR">
    <head>
        <title>Portfolio - BTS SIO SLAM</title>
        <link rel="stylesheet" type="text/css" href="../public/css/style.css">
        <style>
            table {
                border-collapse: collapse;
                width: 100%;
            }
        
            th, td {
                border: 1px solid #dddddd;
                text-align: left;
                padding: 8px;
            }
        
            th {
                background-color: #f2f2f2;
            }
            .checked-cell {
                background-color: blue;
            }
        </style>
    </head>
    <body>
        <a class="skip-link button" href="#site-content">Skip to the content</a>
        <div class="big-wrapper">
            <div class="header-cover section bg-dark-light no-padding">
                <div class="header section" style="background-image: url(../img/coding.webp);">
                    <div class="header-inner section-inner">
                        <div class="blog-info">
                            <div class="blog-title">
                                <a href="#" rel="home">Portfolio - BTS SIO SLAM</a>
                            </div>
                            <p class="blog-description">ARTHUR FOUCAULT</p>
                        </div>
                        <!-- .blog-info -->
                    </div>
                    <!-- .header-inner -->
                </div>
                <!-- .img -->
            </div>
            <div class="navigation section no-padding bg-dark">
                <div class="navigation-inner section-inner">
                    <ul class="blog-menu">
                        <li id="menu-item-18" class="menu-item menu-item-18">
                            <a href="../index.html">Accueil</a>
                        </li>
                        <li id="menu-item-45" class="menu-item menu-item-45">
                            <a href="../CV/index.html">CV</a>
                        </li>
                        <li id="menu-item-100" class="menu-item menu-item-100">
                            <a href="../Formation/index.html">Formation</a>
                        </li>
                        <li id="menu-item-44" class="menu-item menu-item-44">
                            <a href="../VeilleTechnologique/index.html">Veille Technologique</a>
                        </li>
                        <li id="menu-item-43" class="menu-item menu-item-43">
                            <a href="../Projets/index.html">Projets</a>
                        </li>
                        <li id="menu-item-70" class="menu-item menu-item-70">
                            <a href="../Entreprise/index.html">Entreprise</a>
                        </li>
                        <li id="menu-item-153" class="menu-item current-menu-item menu-item-153">
                            <a href="../TableauSynthèse/index.html" aria-current="page">Tableau de Synthèse</a>
                        </li>
                    </ul>
                    <!-- .blog-menu -->
                    <ul class="mobile-menu">
                        <li class="menu-item menu-item-18">
                            <a href="../index.html">Accueil</a>
                        </li>
                        <li class="menu-item menu-item-45">
                            <a href="../CV/index.html">CV</a>
                        </li>
                        <li class="menu-item menu-item-100">
                            <a href="../Formation/index.html">Formation</a>
                        </li>
                        <li class="menu-item menu-item-44">
                            <a href="../VeilleTechnologique/index.html">Veille technologique</a>
                        </li>
                        <li class="menu-item menu-item-43">
                            <a href="../Projets/">Projets</a>
                        </li>
                        <li class="menu-item menu-item-70">
                            <a href="../Entreprise/index.html">Entreprise</a>
                        </li>
                        <li class="menu-item current-menu-item menu-item-153">
                            <a href="../TableauSynthèse/index.html" aria-current="page">Tableau de synthèse</a>
                        </li>
                    </ul>
                    <!-- .mobile-menu -->
                </div>
                <!-- .navigation-inner -->
            </div>
            <!-- .navigation -->
            <main class="wrapper section-inner group" id="site-content">

                <div id="excel-preview"></div>
                
                <a href="../Excel/6- Annexe 6-1 - Tableau de synthèse - Epreuve E4 - BTS SIO 2023.xlsx" download>Télécharger le fichier Excel</a>
            </main>
            <!-- .wrapper -->
            <!-- .contenu -->
            <div class="footer section large-padding bg-dark">
                <div class="footer-inner section-inner group">
                    <div class="column column-1 left">
                        <div class="widgets">
                            <div id="block-17" class="widget widget_block">
                                <div class="widget-content">
                                    <ul class="wp-block-page-list">
                                        <li class="wp-block-pages-list__item">
                                            <a class="wp-block-pages-list__item__link" href="../index.html">Accueil</a>
                                        </li>
                                        <li class="wp-block-pages-list__item">
                                            <a class="wp-block-pages-list__item__link" href="../CV/index.html">CV</a>
                                        </li>
                                        <li class="wp-block-pages-list__item">
                                            <a class="wp-block-pages-list__item__link" href="../Formation/index.html">Formation</a>
                                        </li>
                                        <li class="wp-block-pages-list__item">
                                            <a class="wp-block-pages-list__item__link" href="../Entreprise/index.html">Entreprise</a>
                                        </li>
                                        <li class="wp-block-pages-list__item">
                                            <a class="wp-block-pages-list__item__link" href="../Projets/index.html">Projets</a>
                                        </li>
                                        <li class="wp-block-pages-list__item current-menu-item">
                                            <a class="wp-block-pages-list__item__link" href="../TableauSynthèse/index.html" aria-current="page">Tableau de synthèse</a>
                                        </li>
                                        <li class="wp-block-pages-list__item">
                                            <a class="wp-block-pages-list__item__link" href="../VeilleTechnologique/index.html">Veille technologique</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- .footer-a -->
                    <!-- .footer-b -->
                    <!-- .footer-c -->
                </div>
                <!-- .footer-inner -->
            </div>
            <!-- .footer -->
            <div class="credits section bg-dark no-padding">
                <div class="credits-inner section-inner group">
                    <p class="credits-left">
                        &copy;2023 Portfolio &#8211; BTS SIO SLAM
                    </p>
                    <p class="credits-right">
                        <a
                            title="To the top"
                            class="tothetop"
                            href="#"
                            onclick="scrollToTop(); return false;"
                        >Up &uarr;</a>
                    </p>
                </div>
                <!-- .credits-inner -->
            </div>
            <!-- .credits -->
        </div>
        <!-- .big-wrapper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
        <script>
            // Fonction pour charger le fichier Excel
            function loadExcel(url) {
                var xhr = new XMLHttpRequest();
                xhr.open("GET", url, true);
                xhr.responseType = "arraybuffer";
        
                xhr.onload = function (e) {
                    var arraybuffer = xhr.response;
                    var data = new Uint8Array(arraybuffer);
                    var arr = new Array();
                    for (var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
                    var bstr = arr.join("");
        
                    var workbook = XLSX.read(bstr, { type: "binary" });
                    var sheet_name_list = workbook.SheetNames;
                    var sheet = workbook.Sheets[sheet_name_list[0]];
        
                    // Convertir les données en HTML avec une plage de colonnes de A à H
                    var htmlTable = sheet_to_html_with_range(sheet, { editable: false, display: true, range: 'A1:H' + XLSX.utils.decode_range(sheet["!ref"]).e.r });
        
                    // Supprimer les cellules vides en dessous du tableau
                    var tableContainer = document.createElement('div');
                    tableContainer.innerHTML = htmlTable;
                    cleanTable(tableContainer);
        
                    // Ajouter la classe pour les cellules qui contiennent uniquement un "X"
                    markCheckedCells(tableContainer);
        
                    document.getElementById("excel-preview").innerHTML = tableContainer.innerHTML;
                };
        
                xhr.send();
            }
        
            function sheet_to_html_with_range(sheet, opts) {
                var range = XLSX.utils.decode_range(opts.range);
                var HTML = '<table xmlns:x="urn:schemas-microsoft-com:office:excel" style="vnd.ms-excel.numberformat:@;">';
        
                // Stocke les cellules fusionnées pour les réutiliser dans le HTML
                var mergedCells = sheet["!merges"] || [];
        
                for (var R = range.s.r; R <= range.e.r; ++R) {
                    HTML += '<tr>';
                    for (var C = range.s.c; C <= range.e.c; ++C) {
                        var cell_ref = XLSX.utils.encode_cell({ r: R, c: C });
                        var cell = sheet[cell_ref];
        
                        // Vérifie si la cellule est fusionnée
                        var mergedCell = getMergedCell(mergedCells, R, C);
        
                        if (mergedCell && mergedCell.s.r === R && mergedCell.s.c === C) {
                            // La cellule est la cellule de départ de la fusion, utilise rowspan et colspan
                            var rowspan = ' rowspan="' + (mergedCell.e.r - mergedCell.s.r + 1) + '"';
                            var colspan = ' colspan="' + (mergedCell.e.c - mergedCell.s.c + 1) + '"';
                            HTML += '<td' + rowspan + colspan + ' style="' + getCellStyle(cell) + '">' + XLSX.utils.format_cell(cell) + '</td>';
                        } else if (!mergedCell) {
                            // La cellule n'est pas fusionnée, utilise une cellule normale
                            HTML += '<td style="' + getCellStyle(cell) + '">' + XLSX.utils.format_cell(cell) + '</td>';
                        }
                    }
                    HTML += '</tr>';
                }
                HTML += '</table>';
                return HTML;
            }
        
            function cleanTable(container) {
                var table = container.querySelector('table');
                if (table) {
                    var rows = table.getElementsByTagName('tr');
                    for (var i = rows.length - 1; i >= 0; i--) {
                        if (!hasTextContent(rows[i])) {
                            rows[i].parentNode.removeChild(rows[i]);
                        }
                    }
                }
            }
        
            function hasTextContent(element) {
                return element.textContent.trim().length > 0;
            }
        
            function getMergedCell(mergedCells, row, col) {
                for (var i = 0; i < mergedCells.length; i++) {
                    var mergedCell = mergedCells[i];
                    if (row >= mergedCell.s.r && row <= mergedCell.e.r && col >= mergedCell.s.c && col <= mergedCell.e.c) {
                        return mergedCell;
                    }
                }
                return null;
            }
        
            function markCheckedCells(container) {
                var cells = container.querySelectorAll('td');
                cells.forEach(function (cell) {
                    if (cell.textContent.trim() === 'X') {
                        cell.style.backgroundColor = 'lightblue';
                    }
                });
            }
        
            function getCellStyle(cell) {
                if (!cell || !cell.s) return '';
        
                var style = cell.s;
                var cssStyle = '';
        
                if (style.fill && style.fill.type === 'pattern' && style.fill.pattern === 'solid') {
                    cssStyle += 'background-color:' + style.fill.fgColor.rgb.substring(2) + ';';
                }
                if (style.font && style.font.color && style.font.color.rgb) {
                    cssStyle += 'color:' + style.font.color.rgb.substring(2) + ';';
                }
        
                return cssStyle;
            }

            // Charger le fichier Excel au chargement de la page
            document.addEventListener("DOMContentLoaded", function () {
                var excelUrl = "https://arthurfoucault.github.io/Portfolio/Excel/6- Annexe 6-1 - Tableau de synthèse - Epreuve E4 - BTS SIO 2023.xlsx";
                loadExcel(excelUrl);
            });
        </script>
        <script src="../public/js/accueil.js"></script>
        
    </body>
</html>
